---
import { getAboutContent } from '~/lib/sanity';
import Layout from '~/layouts/PageLayout.astro';

import CallToAction from '~/components/widgets/CallToAction.astro';
import Hero from '~/components/widgets/Hero.astro';
import Steps2 from '~/components/widgets/Steps2.astro';

// Get content from Sanity
const pageData = await getAboutContent('es');
const { metadata, heroWidget, steps2Sections, cta } = pageData || {};
---

<Layout metadata={metadata}>
  <!-- Hero Widget ******************* -->

  {heroWidget && (
    <Hero
      image={heroWidget.image}
      actions={heroWidget.actions}
    >
      <Fragment slot="title">{heroWidget.title}</Fragment>
      <Fragment slot="subtitle">{heroWidget.subtitle}</Fragment>
    </Hero>
  )}

  <!-- Steps2 Widgets ****************** -->

  {steps2Sections && steps2Sections.map((section) => (
    <Steps2
      title={section.title}
      subtitle={section.subtitle}
      items={section.items}
      isReversed={section.isReversed}
      callToAction={section.callToAction}
    />
  ))}

  <!-- CallToAction Widget *********** -->

  {cta && (
    <CallToAction
      actions={cta.actions}
    >
      <Fragment slot="title">{cta.title}</Fragment>
      <Fragment slot="subtitle">{cta.subtitle}</Fragment>
    </CallToAction>
  )}
</Layout>